<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
            integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
            crossorigin="anonymous"
        >
        <link rel="stylesheet" href="https://cdn-uicons.flaticon.com/uicons-regular-straight/css/uicons-regular-straight.css">
        <link href="../assets/css/icons.css" rel="stylesheet">
        <title>Hello, world!</title>
        <script>
        if (!localStorage.getItem("authtoken")) {
            window.location = "./login_module.html"
        }
        </script>
        <style>
        .form-control {
            display: block;
            width: 100%;
            padding: 0.645rem 0.75rem;
            font-size: 1rem;
            line-height: 1.5;
            color: #495057;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #ced4da;
            border-radius: 0.25rem;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }
        .form-control1 {
            display: block;
            width: 100%;
            padding: 0.475rem 0.75rem;
            font-size: 1rem;
            line-height: 1.5;
            color: #495057;
            background-color: #fff;
            background-clip: padding-box;
            border: 1px solid #ced4da;
            border-radius: 0.25rem;
            transition: border-color .15s ease-in-out, box-shadow .15s ease-in-out;
        }
        .card-form__button {
            width: 100%;
            height: 55px;
            background: #2364d2;
            border: none;
            border-radius: 5px;
            font-size: 22px;
            font-weight: 500;
            font-family: "Source Sans Pro", sans-serif;
            box-shadow: 3px 10px 20px 0px rgba(35, 100, 210, 0.3);
            color: #fff;
            margin-top: 20px;
            cursor: pointer;
        }
        </style>
    </head>
    <body style="background: #439eee;">
        <div class="container">
            <div class="row" style="display: flex; justify-content: center; align-items: center; height: 100vh;">
                <div class="col-lg-6">
                    <div class="card" style="box-shadow: 0 30px 60px 0 rgba(90, 116, 148, 0.4); border-radius: 0px;">
                        <div class="card-header text-center">
                            <h3>
                                <i class="fi fi-rs-lock"></i> PAYMENT
                            </h3>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-lg-12">
                                    <form action="/charge" method="post" id="payment-form">
                                        <div class="row">
                                            <div class="col-lg-12">
                                                <div class="field form-group">
                                                    <label for="card-number" data-tid="scwsdk.form.card_number_label">
                                                        Card number
                                                    </label>
                                                    <div id="card-number" class="input form-control"></div>
                                                    <div class="underline"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-lg-12">
                                                <label for="amount" data-tid="amount">
                                                    Amount
                                                </label>
                                                <div class="field form-group">
                                                    <div class="input"></div>
                                                    <div class="underline">
                                                        <input id="amount" class="input form-control1">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-lg-12">
                                                <div class="field form-group">
                                                    <label for="card-expiry" data-tid="scwsdk.form.card_expiry_label">
                                                        Expiration
                                                    </label>
                                                    <div id="card-expiry" class="input empty form-control"></div>
                                                    <div class="underline"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-lg-12">
                                                <div class="field form-group">
                                                    <label for="card-cvc" data-tid="scwsdk.form.card_cvc_label">
                                                        CVC
                                                    </label>
                                                    <div id="card-cvc" class="input empty form-control"></div>
                                                    <div class="underline "></div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" style="display: flex; justify-content: center; align-items: center;">
                                    <div class="col-lg-6">
                                    </form>
                                    <button onclick="main()" class="card-form__button">Submit Payment</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="../assets/js/jquery.min.js"></script>
        <script src="https://cdn.safecharge.com/safecharge_resources/v1/websdk/safecharge.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
        <script>
        var sfc = SafeCharge({
            env: 'int', // Nuvei API environment - 'int' (integration) or 'prod' (production - default if omitted)
            merchantId: '6400701569295268447', // your Merchant ID provided by Nuvei
            merchantSiteId: '244298' // your Merchant Site ID provided by Nuvei
        });
        var ScFields = sfc.fields({
            fonts: [
                { cssUrl: 'https://fonts.googleapis.com/css?family=Roboto' }, // include your custom fonts
            ]
        })
        var ScFieldStyles = {
            base: {
                color: '#32325D',
                fontWeight: 500,
                fontFamily: 'Roboto, Consolas, Menlo, monospace',
                fontSize: '16px',
                fontSmoothing: 'antialiased',
                '::placeholder': {
                    color: '#CFD7DF',
                },
                ':-webkit-autofill': {
                    color: '#e39f48',
                },
            },
            invalid: {
                color: '#E25950',
                '::placeholder': {
                    color: '#FFCCA5',
                },
            },
        };
        var ScFieldClasses = {
            focus: 'focused',
            empty: 'empty',
            invalid: 'invalid',
            complete: 'complete',
        };
        var scard = ScFields.create('ccNumber', {
            style: ScFieldStyles,
            classes: ScFieldClasses,
        });
        scard.attach('#card-number');
        var cardExpiry = ScFields.create('ccExpiration', {
            style: ScFieldStyles,
            classes: ScFieldClasses,
        });
        cardExpiry.attach('#card-expiry');
        var cardCvc = ScFields.create('ccCvc', {
            style: ScFieldStyles,
            classes: ScFieldClasses,
        });
        cardCvc.attach('#card-cvc');
        function main() {
            $.ajax({
                url: 'https://backend.app.spaderent.com/api/spade/openOrder',
                type: 'POST',
                data: JSON.stringify({
                    amount: "1.25",
                    currency: "USD",
                    "userTokenId": "370",
                }),
                contentType: "application/json; charset=utf-8",
                processData: false,
                headers: {
                    'Authorization': 'Bearer ' + localStorage.getItem("authtoken")
                },
                success: function (response) {
                    console.log(scard)
                    // sfc.createPayment({
                    //     sessionToken: response.sessionToken, //received from openOrder API
                    //     clientUniqueId: "695701003",
                    //     merchantId:"6400701569295268447",
                    //     merchantSiteId:"244298",
                    //     cardHolderName: "<card_holder>",
                    //     paymentOption: {
                    //         userPaymentOptionId: "95475308",
                    //         card:{
                    //         }
                    //     },
                    //     billingAddress: {
                    //         email: "someone@somedomain.com",
                    //         country: "GB"
                    //     }
                    // }, function (res) {
                    //     console.log(res)
                    // });
                    sfc.createPayment({
  sessionToken: response.sessionToken,
  paymentOption: {
    alternativePaymentMethod: {
      paymentMethod: "apmgw_ACH",
      AccountNumber: "111111111",
      RoutingNumber: "123456780"
    }
  },
  deviceDetails: {
    ipAddress: "100.128.0.0"
  },
  billingAddress: {
    firstName: "John",
    lastName: "Smith",
    email: "john.smith@email.com",
    phone: "6175551414",
    address: "22 Main Street",
    city: "Boston",
    zip: "02460",
    state: "MA",
    country: "US"
  },
  userDetails: {
    firstName: "John",
    lastName: "Smith",
    email: "john.smith@email.com",
    phone: "6175551414",
    address: "22 Main Street",
    city: "Boston",
    zip: "02460",
    state: "MA",
    country: "US",
    identification: "123456789"
  }
}, function(res) {
  console.log(res);

})

                        },
                error: function (xhr, status, error) {
                    console.log(xhr)
                    console.log(status)
                    console.log(error)
                    console.error('Error sending data:', error);
                }
            });
        }
        </script>
        <script>

        </script>
    </html>
