<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
            integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
            crossorigin="anonymous"
        >
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <link id="style" href="../assets/plugins/bootstrap/css/bootstrap.min.css" rel="stylesheet">
        <link rel="shortcut icon" type="image/x-icon" href="../assets/images/brand/favicon.ico">
        <link href="../assets/css/style.css" rel="stylesheet">
        <link href="../assets/css/dark-style.css" rel="stylesheet">
        <link href="../assets/css/transparent-style.css" rel="stylesheet">
        <link href="../assets/css/skin-modes.css" rel="stylesheet">
        <link href="../assets/css/icons.css" rel="stylesheet">
        <link
            id="theme"
            rel="stylesheet"
            type="text/css"
            media="all"
            href="../assets/colors/color1.css"
        >
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,wght@0,400;0,500;0,700;1,400;1,500;1,700&family=Figtree:ital,wght@0,400;0,500;0,600;0,700;0,800;0,900;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">
        <title>Spade Rent | Forget-password</title>
        <link rel="stylesheet" href="../assets/pageCss/landlordCss/verification.css">
    </head>
    <body onload="check()">
        <div id="preloader" class="tlp-preloader">
            <div class="animation-preloader">
                <div class="tlp-spinner"></div>
                <img src="../assets/images/logo-preloader.png" alt="Preloader" style="width: 65px;">
            </div>
        </div>
        <div
            class="modal fade"
            id="myModal_warning_connection"
            tabindex="-1"
            role="dialog"
        >
            <div class="modal-dialog modal-dialog-centered text-center" role="document">
                <div class="modal-content modal-content-demo">
                    <div class="modal-body p-0">
                        <div class="card border p-0 pb-3" style="margin-bottom: 0rem;">
                            <div class="card-body text-center">
                                <span class="">
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        height="60"
                                        width="60"
                                        viewBox="0 0 24 24"
                                    >
                                        <path fill="#fad383" d="M15.728,22H8.272a1.00014,1.00014,0,0,1-.707-.293l-5.272-5.272A1.00014,1.00014,0,0,1,2,15.728V8.272a1.00014,1.00014,0,0,1,.293-.707l5.272-5.272A1.00014,1.00014,0,0,1,8.272,2H15.728a1.00014,1.00014,0,0,1,.707.293l5.272,5.272A1.00014,1.00014,0,0,1,22,8.272V15.728a1.00014,1.00014,0,0,1-.293.707l-5.272,5.272A1.00014,1.00014,0,0,1,15.728,22Z"/>
                                        <circle
                                            cx="12"
                                            cy="16"
                                            r="1"
                                            fill="#f7b731"
                                        />
                                        <path fill="#f7b731" d="M12,13a1,1,0,0,1-1-1V8a1,1,0,0,1,2,0v4A1,1,0,0,1,12,13Z"/>
                                    </svg>
                                </span>
                                <h4 class="h4 mb-0 mt-3 fw-bold">Warning</h4>
                                <p class="card-text text-dark m-0">Sorry! Something went wrong.</p>
                                <p class="card-text text-dark m-0">Kindly check your internet connection or please try again later.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div
            class="modal fade"
            id="infoModal"
            tabindex="-1"
            role="dialog"
        >
            <div class="modal-dialog modal-dialog-centered text-center" role="document">
                <div class="modal-content modal-content-demo">
                    <div class="modal-body p-0">
                        <div class="card border p-0 pb-3" style="margin-bottom: 0rem">
                            <div class="card-body text-center">
                                <span class="">
                                    <svg
                                        xmlns="http://www.w3.org/2000/svg"
                                        height="60"
                                        width="60"
                                        viewBox="0 0 24 24"
                                    >
                                        <path fill="#13bfa6" d="M10.3125,16.09375a.99676.99676,0,0,1-.707-.293L6.793,12.98828A.99989.99989,0,0,1,8.207,11.57422l2.10547,2.10547L15.793,8.19922A.99989.99989,0,0,1,17.207,9.61328l-6.1875,6.1875A.99676.99676,0,0,1,10.3125,16.09375Z" opacity=".99"/>
                                        <path fill="#71d8c9" d="M12,2A10,10,0,1,0,22,12,10.01146,10.01146,0,0,0,12,2Zm5.207,7.61328-6.1875,6.1875a.99963.99963,0,0,1-1.41406,0L6.793,12.98828A.99989.99989,0,0,1,8.207,11.57422l2.10547,2.10547L15.793,8.19922A.99989.99989,0,0,1,17.207,9.61328Z"/>
                                    </svg>
                                </span>
                                <h4 class="h4 mb-0 mt-3 fw-bold">Info</h4>
                                <p class="card-text text-dark">Sended Successfully</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="wapper">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-12 p-0 mt-6">
                        <div class="img">
                            <div class="main-div">
                                <div class="container-fluid setcon-fluid">
                                    <div class="row d-flex justify-content-center">
                                        <div class="main-div">
                                            <span>
                                                <img
                                                    src="../assets/images/Artboard GÇô 1.svg"
                                                    alt="Rent-logo"
                                                    class="Rent-logo marginset"
                                                    id="logo"
                                                >
                                            </span>
                                        </div>
                                        <div class="col-lg-12 col-md-12">
                                            <div class="row justify-content-center">
                                                <div class="col-lg-5 card1 p-0 card" id="card1">
                                                    <div style="
                              display: flex;
                              justify-content: center;
                              padding-top: 25px;
                            ">
                                                        <img
                                                            src="../assets/images/envelope.png"
                                                            alt=""
                                                            height="56px"
                                                            width="56px"
                                                        >
                                                    </div>
                                                    <div class="heading">
                                                        <h3 class="text-center" style="font-weight: 700">
                                                            Verify Your Email Address
                                                        </h3>
                                                    </div>
                                                    <div class="p-3">
                                                        <div class="p-align">
                                                            <p class="text-center">
                                                                A verification code has been sent to your email address Enter the code below and click Verify Code.
                                                            </p>
                                                        </div>
                                                        <div class="p-aligns">
                                                            <p class="text-center" style="font-weight: 700">
                                                                6-digits code *
                                                            </p>
                                                        </div>
                                                        <div class="inputs">
                                                            <form action="">
                                                                <div class="row">
                                                                    <div class="col-12">
                                                                        <div class="form-group">
                                                                            <input
                                                                                type="text"
                                                                                class="form-control input-inside"
                                                                                id="verification"
                                                                                aria-describedby="verificationHelp"
                                                                                maxlength="6"
                                                                                oninput="this.value = this.value.replace(/[^0-9]/g, ''); validatecode();"
                                                                                placeholder="Enter 6-Digit Code"
                                                                            >
                                                                            <span class="mt-1 text-danger" id="verification-spans" style="display: none">
                                                                                Verification code is invalid. Please enter a Valid Code
                                                                            </span>
                                                                            <span class="mt-1 text-danger" id="expired-spans" style="display: none">
                                                                                Verification Code has been expired!
                                                                            </span>
                                                                            <span class="mt-1" id="verify" style="float: right; font-weight: 700">
                                                                                <span id="verification-text">Verification Code will expire in</span>
                                                                                <span style="color: #1467b0" id="counter">
                                                                                    2:00
                                                                                </span
                                        >
                                                                                <span style="color: #1467b0;display: none;cursor: pointer;" id="send_again">
                                                                                    send again?
                                                                                </span
                                        >
                                                                            </span>
                                                                        </div>
                                                                    </div>
                                                                    <div class="col-12">
                                                                        <div class="pb-2">
                                                                            <div class="form-group"></div>
                                                                            <button
                                                                                type="button"
                                                                                class="btn btn-primary btn-lg btn-block btnn btnstyle"
                                                                                id="continue"
                                                                                disabled
                                                                            >
                                                                                Verification Code
                                                                                <img src="../assets/images/arrow.svg" class="float-right mt-3 mr-2" alt="">
                                                                            </button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div
                                                    class="spinner-border text4-blue me-2"
                                                    style="
                            width: 3rem;
                            height: 3rem;
                            position: absolute;
                            top: 20%;
                            display: none;
                            z-index: 9;
                          "
                                                    role="status"
                                                    id="loader"
                                                >
                                                    <span class="visually-hidden">Loading...</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <script src="../assets/js/jquery.min.js"></script>
        <script src="../assets/plugins/bootstrap/js/popper.min.js"></script>
        <script src="../assets/plugins/bootstrap/js/bootstrap.min.js"></script>
        <script src="../assets/plugins/sidemenu/sidemenu.js"></script>
        <script src="../assets/plugins/bootstrap5-typehead/autocomplete.js"></script>
        <script src="../assets/js/typehead.js"></script>
        <script src="../assets/plugins/sidebar/sidebar.js"></script>
        <script src="../assets/plugins/formwizard/jquery.smartWizard.js"></script>
        <script src="../assets/plugins/formwizard/fromwizard.js"></script>
        <script src="../assets/plugins/jquery-steps/jquery.steps.min.js"></script>
        <script src="../assets/plugins/parsleyjs/parsley.min.js"></script>
        <script src="../assets/plugins/p-scroll/perfect-scrollbar.js"></script>
        <script src="../assets/plugins/p-scroll/pscroll.js"></script>
        <script src="../assets/plugins/p-scroll/pscroll-1.js"></script>
        <script src="../assets/plugins/accordion-Wizard-Form/jquery.accordion-wizard.min.js"></script>
        <script src="../assets/js/form-wizard.js"></script>
        <script src="../assets/plugins/fileuploads/js/fileupload.js"></script>
        <script src="../assets/plugins/fileuploads/js/file-upload.js"></script>
        <script src="../assets/plugins/fancyuploder/jquery.ui.widget.js"></script>
        <script src="../assets/plugins/fancyuploder/jquery.fileupload.js"></script>
        <script src="../assets/plugins/fancyuploder/jquery.iframe-transport.js"></script>
        <script src="../assets/plugins/fancyuploder/jquery.fancy-fileupload.js"></script>
        <script src="../assets/plugins/fancyuploder/fancy-uploader.js"></script>
        <script src="../assets/js/themeColors.js"></script>
        <script src="../assets/js/sticky.js"></script>
        <script src="../assets/js/custom.js"></script>
        <script src="../assets/js/jquery.min.js"></script>
        <script src="../assets/plugins/bootstrap/js/popper.min.js"></script>
        <script src="../assets/plugins/bootstrap/js/bootstrap.min.js"></script>
        <script src="../assets/plugins/counters/counterup.min.js"></script>
        <script src="../assets/plugins/counters/waypoints.min.js"></script>
        <script src="../assets/plugins/counters/counters-1.js"></script>
        <script src="../assets/plugins/owl-carousel/owl.carousel.js"></script>
        <script src="../assets/plugins/company-slider/slider.js"></script>
        <script src="../assets/plugins/rating/jquery-rate-picker.js"></script>
        <script src="../assets/plugins/rating/rating-picker.js"></script>
        <script src="../assets/plugins/ratings-2/jquery.star-rating.js"></script>
        <script src="../assets/plugins/ratings-2/star-rating.js"></script>
        <script src="../assets/js/sticky.js"></script>
        <script src="../assets/js/landing.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/sjcl/1.0.8/sjcl.min.js"></script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
        <script>
        function check() {
            var img = document.getElementById("logo");
            var darkModeElements = document.getElementsByClassName("dark-mode");
            if (darkModeElements.length > 0) {
                img.src = "../assets/images/logo_white.png";
            } else {
                img.src = "../assets/images/Artboard GÇô 1.svg";
            }
        }
        function validatecode() {
            var code = document.getElementById("verification").value;
            if (code.length == 6) {
                document.getElementById("continue").disabled = false;
            } else {
                document.getElementById("continue").disabled = true;
            }
        }
        function nextPage() {
            setTimeout(delay2, 2500);
            window.location.href = "new_password.html";
        }
        function delay2() {
            document.getElementById("loader").style.display = "block";
        }
        </script>
        <script>
        $(document).ready(function() {
            const encryptedId = decodeURIComponent((new URL(document.location)).searchParams.get("id"));
var password = 'your-secret-password';
const Id = sjcl.decrypt(password, encryptedId);
var encodedId = encodeURIComponent(encryptedId);
            $(document).on("click", "#continue", function(a) {
                var verification = $("#verification").val();
                $.ajax({
                    url: 'http://localhost:3000/api/spade/verifyResetEmailCode',
                    type: 'POST',
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({
                        id: Id,
                        token: verification
                    }),
                    success: function(response) {
                        document.getElementById("verification-spans").style.display = "none";
                        var encryptedToken = sjcl.encrypt(password, response.token.toString());
var encodedToken = encodeURIComponent(encryptedToken);
                        window.open(`new_password.html?id=${encodedId}&token=${encodedToken}`, "_self")
                    },
                    error: function(xhr, status, error) {
$('#preloader').css('display','none');
                        document.getElementById("verification-spans").style.display = "block";
                        $("#verification").addClass("is-invalid")
                    }
                });
            });
        });
        </script>
        <script>
var counterElement = document.getElementById("counter");
var send_again = document.getElementById("send_again");
var interval;
if (localStorage.getItem('countdown_seconds') !== 0 || localStorage.getItem('countdown_seconds') === null) {
  var seconds = localStorage.getItem("countdown_seconds") || 120; // Get the saved value or default to 120 seconds
  interval = setInterval(countDown, 1000);
  document.getElementById("verification-text").style.display = "inline";
} else {
  counterElement.style.display = "none";
  send_again.style.display = "inline";
  document.getElementById("verification-text").style.display = "none";
}
function countDown() {
  var minutes = Math.floor(seconds / 60);
  var remainingSeconds = seconds % 60;
  if (remainingSeconds < 10) {
    remainingSeconds = "0" + remainingSeconds;
  }
  if (minutes === 0) {
    counterElement.innerHTML = remainingSeconds + " seconds";
  } else {
    counterElement.innerHTML = minutes + ":" + remainingSeconds + " minutes";
  }
  if (seconds === 0) {
    clearInterval(interval);
    counterElement.style.display = "none";
    send_again.style.display = "inline";
    document.getElementById("verification-text").style.display = "none";
    document.getElementById("expired-spans").style.display = "block";
    localStorage.removeItem('countdown_seconds');
  } else {
    seconds--;
    localStorage.setItem("countdown_seconds", seconds); // Save the current value of seconds
    document.getElementById("verification-text").style.display = "inline";
  }
}
send_again.addEventListener("click", function() {
  localStorage.removeItem("countdown_seconds");
});
        </script>
        <script>
        $(document).ready(function() {
            const encryptedId = decodeURIComponent((new URL(document.location)).searchParams.get("id"));
var password = 'your-secret-password';
const Id = sjcl.decrypt(password, encryptedId);
var encodedId = encodeURIComponent(encryptedId);
            $(document).on("click", "#send_again", function(a) {
                $.ajax({
                    url: 'http://localhost:3000/api/spade/resendCode',
                    type: 'POST',
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify({
                        id: Id
                    }),
                    success: function(response) {
                        $("#infoModal").modal("show");
                            setTimeout(function() {
                                $('#infoModal').modal('hide');
                            }, 4000);
                        seconds = 120
                        counterElement.innerHTML = "2:00";
                        counterElement.style.display = "inline";
                        send_again.style.display = "none";
                        document.getElementById("verification-text").style.display="inline"
                        interval = setInterval(countDown, 1000);
                    },
                    error: function(xhr, status, error) {
$('#preloader').css('display','none');
                    }
                });
            });
        });
        </script>
    </body>
</html>
